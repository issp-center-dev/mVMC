% !TEX root = userguide_en.tex
%----------------------------------------------------------
\chapter{Tutorial}
\label{Ch:model}

\section{List of sample files}

There are following tutorials in \verb|samples/Standard/|.

\begin{itemize}
\item The Hubbard model on the two dimensional square lattice

  (\verb|samples/Standard/Hubbard/square/|)
\item The Hubbard model on the two dimensional triangular lattice
  
  (\verb|samples/Standard/Hubbard/triangular/|)
\item The one dimensional Kondo chain

  (\verb|samples/Standard/Kondo/chain/|)
\item The one dimensional antiferromagnetic Heisenberg chain
  
  (\verb|samples/Standard/Spin/HeisenbergChain/HeisenbergChain/|)
\item The antiferromagnetic Heisenberg model on the two dimensional square lattice
  
  (\verb|samples/Standard/Spin/HeisenbergSquare/|)

\item The antiferromagnetic Heisenberg model on the two dimensional Kagome lattice
  
  (\verb|samples/Standard/Spin/Kagome/|)

\end{itemize}

We can perform these tutorials in the same way. 
In the following, the tutorial of the one dimensional antiferromagnetic Heisenberg chain is shown.

\section{Heisenberg model}

This tutorial should be performed in 
\begin{verbatim}
sample/Standard/Spin/HeisenbergChain/.
\end{verbatim}

This directory contains the following things:

The input file: StdFace.def

reference outputs: reference/

In this case, we treat the one dimensional antiferromagnetic Heisenberg chain
which has a nearest neighbor spin coupling.
\begin{align}
  {\hat H} = J \sum_{i=1}^{N_{\rm site}} {\hat {\boldsymbol S}}_i \cdot {\hat {\boldsymbol S}}_{i+1}
\end{align}

The input file is as follows:
\\
\begin{minipage}{10cm}
\begin{screen}
\begin{verbatim}
L = 16
Lsub=4
model = "Spin"
lattice = "chain lattice"
J = 1.0
2Sz = 0
NMPtrans=1
\end{verbatim}
\end{screen}
\end{minipage}
%
\\
In this tutorial, J and the number of sites are set to 1 (arbitrary unit) and 16 respectively.

\subsubsection{Making detailed input files}
In mVMC, the detailed input files should be made as a first step.
We first execute the following command. 

\vspace{1cm}\hspace{-0.7cm}
\verb|$ |\underline{Path}\verb|/vmcdry.out StdFace.def|
\small
\\ \\
Then,  we can see the following standard outputs in the terminal.

\begin{verbatim} 
######  Standard Intarface Mode STARTS  ######

  Open Standard-Mode Inputfile StdFace.def 

  KEYWORD : l                    | VALUE : 16 
  KEYWORD : lsub                 | VALUE : 4 
  KEYWORD : model                | VALUE : spin 
  KEYWORD : lattice              | VALUE : chain 
  KEYWORD : j                    | VALUE : 1.0 
  KEYWORD : nmptrans             | VALUE : 1 

#######  Parameter Summary  #######

  @ Lattice Size & Shape

                L = 16 
             Lsub = 4         
                L = 16        
                W = 1         
           phase0 = 0.00000     ######  DEFAULT VALUE IS USED  ######

  @ Hamiltonian 

               2S = 1           ######  DEFAULT VALUE IS USED  ######
                h = 0.00000     ######  DEFAULT VALUE IS USED  ######
            Gamma = 0.00000     ######  DEFAULT VALUE IS USED  ######
                D = 0.00000     ######  DEFAULT VALUE IS USED  ######
              J0x = 1.00000   
              J0y = 1.00000   
              J0z = 1.00000   

  @ Numerical conditions

             Lsub = 4         
             Wsub = 1         
      ioutputmode = 1           ######  DEFAULT VALUE IS USED  ######

######  Print Expert input files  ######

    qptransidx.def is written.
         filehead = zvo         ######  DEFAULT VALUE IS USED  ######
         filehead = zqp         ######  DEFAULT VALUE IS USED  ######
      NVMCCalMode = 0           ######  DEFAULT VALUE IS USED  ######
     NLanczosMode = 0           ######  DEFAULT VALUE IS USED  ######
    NDataIdxStart = 1           ######  DEFAULT VALUE IS USED  ######
      NDataQtySmp = 1           ######  DEFAULT VALUE IS USED  ######
      NSPGaussLeg = 8           ######  DEFAULT VALUE IS USED  ######
         NMPTrans = 1         
    NSROptItrStep = 1000        ######  DEFAULT VALUE IS USED  ######
     NSROptItrSmp = 100         ######  DEFAULT VALUE IS USED  ######
       NVMCWarmUp = 10          ######  DEFAULT VALUE IS USED  ######
    NVMCIniterval = 1           ######  DEFAULT VALUE IS USED  ######
       NVMCSample = 1000        ######  DEFAULT VALUE IS USED  ######
    NExUpdatePath = 2         
          RndSeed = 123456789   ######  DEFAULT VALUE IS USED  ######
       NSplitSize = 1           ######  DEFAULT VALUE IS USED  ######
           NStore = 0           ######  DEFAULT VALUE IS USED  ######
     DSROptRedCut = 0.00100     ######  DEFAULT VALUE IS USED  ######
     DSROptStaDel = 0.02000     ######  DEFAULT VALUE IS USED  ######
     DSROptStepDt = 0.02000     ######  DEFAULT VALUE IS USED  ######
          NSPStot = 0           ######  DEFAULT VALUE IS USED  ######
      ComplexType = 0           ######  DEFAULT VALUE IS USED  ######
    locspn.def is written.
    trans.def is written.
    interall.def is written.
    jastrowidx.def is written.
    coulombintra.def is written.
    coulombinter.def is written.
    hund.def is written.
    exchange.def is written.
    orbitalidx.def is written.
    gutzwilleridx.def is written.
    namelist.def is written.
    modpara.def is written.
    greenone.def is written.
    greentwo.def is written.

######  Input files are generated.  ######
\end{verbatim}
\normalsize

In the beginning of this run,
files describing the detail of considered Hamiltonian
\begin{itemize}
\item \verb|locspin.def|
\item \verb|trans.def|
\item \verb|coulombinter.def|
\item \verb|coulombintra.def|
\item \verb|exchange.def|
\item \verb|hund.def|
\item \verb|namelist.def|
\item \verb|modpara.def|
\end{itemize}
and files for setting variational parameters
\begin{itemize}
\item \verb|gutzwilleridx.def|
\item \verb|jastrowidx.def|
\item \verb|orbitalidx.def|
\item \verb|qptransidx.def|
\end{itemize}
and files specifying elements of correlation functions
that will be calculated 
\begin{itemize}
\item \verb|greenone.def|
\item \verb|greentwo.def|
\end{itemize}
are generated. The details of these files are shown in Sec. \ref{Ch:HowToExpert}.

\subsubsection{Running}
By reading the detailed input files, mVMC executes the calculation of optimizing the variational parameters.

We execute the following command. \\
\verb|$ mpiexec -np |\textit{number\_of\_processes}\verb| |\textit{Path}\verb|/vmcdry.out namelist.def|

The MPI command depends on your system (such as \verb|mpiexec|, \verb|mpirun|, \verb|mpijob|,
\verb|poe|, etc.).
Then, the calculation starts and the following standard message is outputted in the terminal.

\begin{verbatim}
-----------
Start: Read *def files.
  Read File namelist.def .
  Read File 'modpara.def' for ModPara.
  Read File 'locspn.def' for LocSpin.
  Read File 'trans.def' for Trans.
  Read File 'coulombintra.def' for CoulombIntra.
  Read File 'coulombinter.def' for CoulombInter.
  Read File 'hund.def' for Hund.
  Read File 'exchange.def' for Exchange.
  Read File 'gutzwilleridx.def' for Gutzwiller.
  Read File 'jastrowidx.def' for Jastrow.
  Read File 'orbitalidx.def' for Orbital.
  Read File 'qptransidx.def' for TransSym.
  Read File 'greenone.def' for OneBodyG.
  Read File 'greentwo.def' for TwoBodyG.
End  : Read *def files.
Start: Read parameters from *def files.
End  : Read parameters from *def files.
Start: Set memories.
End  : Set memories.
Start: Initialize parameters.
End  : Initialize parameters.
Start: Initialize variables for quantum projection.
End  : Initialize variables for quantum projection.
Start: Optimize VMC parameters.
End  : Optimize VMC parameters.
-----------
\end{verbatim}

Under the calculation, the following file is outputted:\\
\begin{minipage}{12cm}
  \begin{screen}
\begin{verbatim}
zvo_SRinfo.dat
zvo_out_001.dat
zvo_time_001.dat
zvo_var_001.dat
zvo_CalcTimer.dat
\end{verbatim}
  \end{screen}
\end{minipage}

In \verb|zvo_out_001.dat|, the following quantities are outputted at each bins  
\begin{equation}
\langle H \rangle, \langle H^2 \rangle, \frac{\langle H^2 \rangle- \langle H \rangle^2 }{\langle H \rangle^2} \nonumber.
\end{equation}
By seeing these informations, the conversion of the calculation can be judged. 
By using gnuplot, we can check the evolution of $\langle H \rangle$ as follows:
\begin{verbatim}
plot "zvo_out_001.dat" u 1
\end{verbatim}
The details of these outputted files are shown in Sec. \ref{Sec:outputfile}.\\

\subsubsection{Output results}
After finishing calculation normally, the files for the energy, the deviation, the optimized variational parameters and the time of execution for each calculation steps are outputted. In the following, the outputted files are shown \\
\begin{minipage}{12cm}
\begin{screen}
\begin{verbatim}
gutzwiller_opt.dat
jastrow_opt.dat
orbital_opt.dat
zqp_opt.dat
ClacTimer.dat
\end{verbatim}
\end{screen}
\end{minipage}

The details of these outputted files are shown in Sec. \ref{Sec:outputfile}.\\

\subsubsection{Calculation of Green functions}
After changing the value of \verb|NVMCCalMode| from 0 to 1 in \verb|modpara.def| file, we execute the following command. 
When we add \verb|"zqp_opt.dat"| after \verb|"namelist.dat"| as a commandline argument
as follows,
the calculation of Green functions is done by using the optimized variational parameters. 

\vspace{1cm}\hspace{-0.7cm}
\verb|$ |\underline{Path}\verb|/vmc.out namelist.def zqp_opt.dat|
\small

After finishing the calculation, the following files are outputted.
\\
\begin{minipage}{12cm}
\begin{screen}
\begin{verbatim}
zvo_cisajs_001.dat
zvo_cisajscktalt_001.dat
\end{verbatim}
\end{screen}
\end{minipage}
\\
The details of these outputted files are shown in Sec. \ref{Sec:outputfile}.\\

In mVMC, the calculation is done by reading input files categorized by the following six parts. 
\begin{description}
\item[(1)~List:] Specify the kinds and names of input files. 
\item[(2)~Basic parameters:] Specify the basic parameters.
\item[(3)~Set Hamiltonian:] Specify the Hamiltonian.
\item[(4)~Set condition of variational parameters :] Specify the variational parameters to be optimized.
\item[(5)~Initial variational parameters:] Specify the initial values of the variational parameters.
\item[(6)~Output:] Specify the components of one-body and two-body Green's functions to be outputted.
\end{description}

The calculation for complex models can be done by directly making above input files. 
The details for each files are shown in Sec. \ref{Ch:HowToExpert}.
