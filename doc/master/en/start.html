<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>How to use mVMC? &#8212; mVMC 1.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=89b800e6" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=4c8675c2"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial" href="tutorial.html" />
    <link rel="prev" title="What is mVMC?" href="intro.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="What is mVMC?"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mVMC 1.2.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">How to use mVMC?</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="how-to-use-mvmc">
<h1>How to use mVMC?<a class="headerlink" href="#how-to-use-mvmc" title="Permalink to this heading">¶</a></h1>
<section id="prerequisite">
<h2>Prerequisite<a class="headerlink" href="#prerequisite" title="Permalink to this heading">¶</a></h2>
<p>mVMC requires the following packages:</p>
<ul class="simple">
<li><p>C compiler (intel, Fujitsu, GNU, etc. )</p></li>
<li><p>MPI library</p></li>
<li><p>Option: ScaLAPACK library (intel MKL, Fujitsu, ATLAS, etc.)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Settings of intel compiler</strong></p>
<p>When you use the intel compiler, you can use easily scripts attached to
the compiler. In the case of the bash in 64 bit OS, write the following
in your <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>/opt/intel/bin/compilervars.sh<span class="w"> </span>intel64
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>/opt/intel/bin/iccvars.sh<span class="w"> </span>intel64
$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>/opt/intel/mkl/bin/mklvars.sh
</pre></div>
</div>
<p>Please read manuals of your compiler/library for more information.</p>
</div>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h2>
<p>You can download mVMC in the following place.
<a class="reference external" href="https://github.com/issp-center-dev/mVMC/releases">https://github.com/issp-center-dev/mVMC/releases</a></p>
<p>You can obtain the mVMC directory by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>tar<span class="w"> </span>xzvf<span class="w"> </span>mVMC-xxx.tar.gz
</pre></div>
</div>
<p>There are two kind of procedures to install mVMC.</p>
<section id="using-mvmcconfig-sh">
<h3>Using <code class="docutils literal notranslate"><span class="pre">mVMCconfig.sh</span></code><a class="headerlink" href="#using-mvmcconfig-sh" title="Permalink to this heading">¶</a></h3>
<p>Please run <code class="docutils literal notranslate"><span class="pre">mVMCconfig.sh</span></code> script in the mVMC directory as follow (for
ISSP system-B “sekirei”):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>bash<span class="w"> </span>mVMCconfig.sh<span class="w"> </span>sekirei
</pre></div>
</div>
<p>Then environmental configuration file <code class="docutils literal notranslate"><span class="pre">make.sys</span></code> is generated in
<code class="docutils literal notranslate"><span class="pre">src/</span></code> directory. The command-line argument of <code class="docutils literal notranslate"><span class="pre">mVMCconfig.sh</span></code> is as
follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sekirei</span></code> : ISSP system-B “sekirei”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kei</span></code> : K computer and ISSP system-C “maki”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">intel-openmpi</span></code> : Intel compiler + OpenMPI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">intel-mpich</span></code> : Intel compiler + MPICH2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">intel-intelmpi</span></code> : Intel compiler + IntelMPI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcc-openmpi</span></code> : GCC + OpenMPI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcc-mpich-mkl</span></code> : GCC + MPICH + MKL</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">make.sys</span></code> is as follows (for ISSP-system-B “sekirei”):</p>
<div class="highlight-makefile notranslate"><div class="highlight"><pre><span></span><span class="nv">CC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>mpicc
<span class="nv">F90</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>mpif90
<span class="nv">CFLAGS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-O3<span class="w"> </span>-no-prec-div<span class="w"> </span>-xHost<span class="w"> </span>-qopenmp<span class="w"> </span>-Wno-unknown-pragmas
<span class="nv">FFLAGS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-O3<span class="w"> </span>-implicitnone<span class="w"> </span>-xHost
<span class="nv">LIBS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-L<span class="w"> </span><span class="k">$(</span>MKLROOT<span class="k">)</span>/lib/intel64<span class="w"> </span>-lmkl_scalapack_lp64<span class="w"> </span>-lmkl_intel_lp64<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-lmkl_intel_thread<span class="w"> </span>-lmkl_core<span class="w"> </span>-lmkl_blacs_sgimpt_lp64<span class="w"> </span>-lpthread<span class="w"> </span>-lm
<span class="nv">SFMTFLAGS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-no-ansi-alias<span class="w"> </span>-DHAVE_SSE2
</pre></div>
</div>
<p>We explain macros of this file as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CC</span></code> : C compiler (<code class="docutils literal notranslate"><span class="pre">mpicc</span></code>, <code class="docutils literal notranslate"><span class="pre">mpifccpx</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">F90</span></code> : fortran compiler (<code class="docutils literal notranslate"><span class="pre">ifort</span></code>, <code class="docutils literal notranslate"><span class="pre">frtpx</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Libs</span></code> : Linker option</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CFLAGS</span></code> : C compile option</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FFLAGS</span></code> : fortran compile option</p></li>
</ul>
<p>Then you are ready to compile mVMC. Please type</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>make<span class="w"> </span>mvmc
</pre></div>
</div>
<p>and obtain <code class="docutils literal notranslate"><span class="pre">vmc.out</span></code> and <code class="docutils literal notranslate"><span class="pre">vmcdry.out</span></code> in <code class="docutils literal notranslate"><span class="pre">src/</span></code> directory; you
should add this directory to the <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>.</p>
<p>You can make a PATH to mVMC as follows:
<code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">export</span> <span class="pre">PATH=${PATH}:</span></code><em>mVMC_top_directory</em><code class="docutils literal notranslate"><span class="pre">/src/</span></code>
If you keep this PATH, you should write above in <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> (for
<code class="docutils literal notranslate"><span class="pre">bash</span></code> as a login shell)</p>
</section>
<section id="using-cmake">
<h3>Using <code class="docutils literal notranslate"><span class="pre">cmake</span></code><a class="headerlink" href="#using-cmake" title="Permalink to this heading">¶</a></h3>
<p>We can compile mVMC as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span><span class="nv">$HOME</span>/build/mvmc
cmake<span class="w"> </span>-DCONFIG<span class="o">=</span>gcc<span class="w"> </span><span class="nv">$PathTomvmc</span>
make
</pre></div>
</div>
<p>Here, we set a path to mVMC as <code class="docutils literal notranslate"><span class="pre">$PathTomvmc</span></code> and to a build directory
as `` $HOME/build/mvmc``. After compilation, <code class="docutils literal notranslate"><span class="pre">src</span></code> directory is
constructed below a <code class="docutils literal notranslate"><span class="pre">$HOME/build/mvmc</span></code> directory and we obtain an
executable <code class="docutils literal notranslate"><span class="pre">vmc.out</span></code> in <code class="docutils literal notranslate"><span class="pre">src/</span></code> directory.</p>
<p>In the above example, we compile mVMC by using a gcc compiler. We can
select a compiler by using the following options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sekirei</span></code> : ISSP system-B “sekirei”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fujitsu</span></code> : Fujitsu compiler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">intel</span></code> : Intel compiler + Linux PC</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcc</span></code> : GCC compiler + Linux PC.</p></li>
</ul>
<p>An example of compiling mVMC by using the Intel compiler is shown as
follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>./build
<span class="nb">cd</span><span class="w"> </span>./build
cmake<span class="w"> </span>-DCONFIG<span class="o">=</span>intel<span class="w"> </span>../
make
</pre></div>
</div>
<p>After compilation, <code class="docutils literal notranslate"><span class="pre">src/</span></code> directory is created below the <code class="docutils literal notranslate"><span class="pre">build/</span></code> directory
and an execute <code class="docutils literal notranslate"><span class="pre">vmc.out</span></code> in the <code class="docutils literal notranslate"><span class="pre">src/</span></code> directory. We can select
ScaLAPACK instead of LAPACK for vmc calculation by adding the following
as the cmake option</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">DUSE_SCALAPACK</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DSCALAPACK_LIBRARIES</span><span class="o">=</span><span class="s2">&quot;xxx&quot;</span><span class="o">.</span>
</pre></div>
</div>
<p>Here, xxx is the libraries to use ScaLAPACK. Please note that we must
delete the <code class="docutils literal notranslate"><span class="pre">build/</span></code> directory and repeat the above operations when we
change the compiler.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before using cmake for sekirei, you must type</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>/home/issp/materiapps/tool/env.sh
</pre></div>
</div>
<p>When we type the following in sekirei,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cmake<span class="w"> </span>-DCONFIG<span class="o">=</span>sekirei<span class="w"> </span>../<span class="w"> </span>-DUSE_SCALAPACK<span class="o">=</span>ON<span class="w"> </span>,
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">-DSCALAPACK_LIBRARIES</span></code> is automatically set as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">DSCALAPACK_LIBRARIES</span><span class="o">=</span><span class="s2">&quot;\$</span><span class="si">{MKLROOT}</span><span class="s2">/lib/intel64 -lmkl_scalapack_lp64</span>
<span class="o">-</span><span class="n">lmkl_intel_lp64</span> <span class="o">-</span><span class="n">lmkl_intel_thread</span> <span class="o">-</span><span class="n">lmkl_core</span>
<span class="o">-</span><span class="n">lmkl_blacs_sgimpt_lp64</span><span class="s2">&quot;.</span>
</pre></div>
</div>
<p>When the path to libraries for ScaLAPACK is different in your
circumstance, please set <code class="docutils literal notranslate"><span class="pre">-DSCALAPACK_LIBRARIES</span></code> as the correct path.</p>
</div>
</section>
</section>
<section id="directory-structure">
<h2>Directory structure<a class="headerlink" href="#directory-structure" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>When mVMC-xxx.tar.gz is unzipped, the following directory structure is composed.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.
|-- CMakeLists.txt
|-- COPYING
|-- README.md
|-- config/
|   |-- fujitsu.cmake
|   |-- gcc.cmake
|   |-- intel.cmake
|   `-- sekirei.cmake
|-- dist.sh*
|-- doc/
|   |-- CMakeLists.txt
|   |-- bib/
|   |-- en/
|   |-- figs/
|   |-- ja/
|   |-- package/
|   `-- userguide.html
|-- mVMCconfig.sh
|-- samples/
|   |-- Standard/
|   |   |-- Hubbard/
|   |   |-- Kondo/
|   |   `-- Spin/
|   `-- Wannier/
|       |-- Sr2CuO3/
|       `-- Sr2VO4/
|-- src/
|   |-- ComplexUHF/
|   |-- StdFace/
|   |-- common/
|   |-- mVMC/
|   |-- pfapack/
|   `-- sfmt/
|-- test/
|   |-- CMakeLists.txt
|   |-- python/
|   `-- tool/
`-- tool/
</pre></div>
</div>
</div></blockquote>
</section>
<section id="basic-usage">
<h2>Basic usage<a class="headerlink" href="#basic-usage" title="Permalink to this heading">¶</a></h2>
<p>mVMC works as whether the following two modes:</p>
<ul>
<li><p>Expert mode</p>
<p>mVMC supports the arbitrary fermion-/spin-lattice system; we can
specify the hopping, etc. at each site independently. Although this
makes us able to specify flexibly the target this requires many
input-files, and the setup of the calculation is complicated.</p>
</li>
<li><p>Standard mode</p>
<p>For some typical models (such as the Heisenberg model on the square
lattice), we can start calculation with a few parameters (for
example, the size of the simulation cell, the common coupling
parameter). In this case, the input-files for Expert mode are
automatically generated. Although the number of available systems is
smaller than that number of Expert mode, the setup of the calculation
is easier than in Expert mode.</p>
</li>
</ul>
<p>We can calculate by using these modes as follows:</p>
<ol class="arabic">
<li><p>Prepare a minimal input file</p>
<p>You can choose a model (the Heisenberg model, the Hubbard model,
etc.) and a lattice (the square lattice, the triangular lattice,
etc.) from ones provided; you can specify some parameters (such as
the first/second nearest neighbor hopping integrals, the on-site
Coulomb integral, etc.) for them. The input file format is described
in <a class="reference internal" href="standard.html#howtostandard"><span class="std std-ref">Input files for Standard mode</span></a>.</p>
</li>
<li><p>Run</p>
<p>Run a executable <code class="docutils literal notranslate"><span class="pre">vmc.out</span></code> in terminal by specifying the name of
input file written in previous step (option <code class="docutils literal notranslate"><span class="pre">-s</span></code> is required).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mpiexec<span class="w"> </span>-np<span class="w"> </span>number-of-processes<span class="w"> </span>Path/vmc.out<span class="w"> </span>-s<span class="w"> </span>Input-file-name
</pre></div>
</div>
<p>When you use a queuing system in workstations or super computers,
sometimes the number of processes is specified as an argument for the
job-submitting command. If you need more information, please refer
manuals for your system.</p>
</li>
<li><p>Watch calculation logs</p>
<p>Log files are outputted in the <code class="docutils literal notranslate"><span class="pre">output/</span></code> directory which is
automatically made in the directory for a calculation scenario. The
details of output files are shown in <a class="reference internal" href="output.html#outputfile"><span class="std std-ref">Output files</span></a>.</p>
</li>
<li><p>Results</p>
<p>If the calculation is finished normally, the result files are
outputted in the <code class="docutils literal notranslate"><span class="pre">output/</span></code> directory. The details of output files
are shown in <a class="reference internal" href="output.html#outputfile"><span class="std std-ref">Output files</span></a>.</p>
</li>
<li><p>Prepare and run Expert mode</p>
<p>In the above case, the calculation starts as soon as input files for
Expert mode are generated. If we only generate files without starting
the calculation, we can use a executable <code class="docutils literal notranslate"><span class="pre">vmcdry.out</span></code> as follows
(MPI is not used in this step):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>Path/vmcdry.out<span class="w"> </span>Input-file-name
</pre></div>
</div>
<p>Then, we can edit generated files by hand and run a executable
<code class="docutils literal notranslate"><span class="pre">vmc.out</span></code> with <code class="docutils literal notranslate"><span class="pre">namelist.def</span></code> as an argument (option <code class="docutils literal notranslate"><span class="pre">-e</span></code> is
required) as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mpiexec<span class="w"> </span>-np<span class="w"> </span>number-of-processes<span class="w"> </span>Path/vmc.out<span class="w"> </span>-e<span class="w"> </span>namelist.def
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>The number of threads for OpenMP</strong></p>
<p>If you specify the number of OpenMP threads for mVMC, you should set it
as follows (in case of 16 threads) before the running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">16</span>
</pre></div>
</div>
</div>
</section>
<section id="printing-version-id">
<h2>Printing version ID<a class="headerlink" href="#printing-version-id" title="Permalink to this heading">¶</a></h2>
<p>By using <code class="docutils literal notranslate"><span class="pre">-v</span></code> option as follows, you can check which version of mVMC
you are using.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>PATH/vmcdry.out<span class="w"> </span>-v
$<span class="w"> </span>PATH/vmc.out<span class="w"> </span>-v
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/mVMC.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">How to use mVMC?</a><ul>
<li><a class="reference internal" href="#prerequisite">Prerequisite</a></li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#using-mvmcconfig-sh">Using <code class="docutils literal notranslate"><span class="pre">mVMCconfig.sh</span></code></a></li>
<li><a class="reference internal" href="#using-cmake">Using <code class="docutils literal notranslate"><span class="pre">cmake</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#directory-structure">Directory structure</a></li>
<li><a class="reference internal" href="#basic-usage">Basic usage</a></li>
<li><a class="reference internal" href="#printing-version-id">Printing version ID</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="intro.html"
                          title="previous chapter">What is mVMC?</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="tutorial.html"
                          title="next chapter">Tutorial</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/start.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorial"
             >next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="What is mVMC?"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mVMC 1.2.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">How to use mVMC?</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2017, mVMC team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    </div>
  </body>
</html>